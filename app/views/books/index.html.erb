<%= render 'layouts/top_panel' %>
<p id="notice"><%= notice %></p>

<nav>
  <h1>Books</h1>



  <table class="table table-condensed table-bordered">
    <thead>
    <tr class="success">
      <th><%=link_to 'Title', books_path(sort:'title') %></th>
      <th><%=link_to 'Author', books_path(sort:'author') %></th>
      <th><%=link_to 'Price', books_path(sort:'price') %></th>
      <th><%=link_to 'Page count', books_path(sort:'page_count') %></th>
      <th><%=link_to 'About', books_path(sort:'about') %></th>
      <th><%=link_to 'User', books_path(sort:'user_id') %></th>
      <th><%=link_to 'created_at', books_path(sort:'created_at') %></th>
      <th><%=link_to 'Binding', books_path(sort:'binding') %></th>
      <th><%=link_to 'Genre', books_path(sort:'genre') %></th>
      <th colspan="3">
        <div class="field">
          <%= form_tag books_path, :method => 'get' do %>
              <p>
                <%= text_field_tag :search, params[:search] %>
                <%= submit_tag "Search", :name => nil %>
              </p>
          <% end %>
        </div>
      </th>
      <th colspan="3"></th>
    </tr>
    </thead>

    <tbody>
      <% @books.each do |book| %>
        <tr>
          <td class="col-md-1 active"><%= book.title %></td>
          <td><%= book.author %></td>
          <td class="col-md-1"><%= book.price %></td>
          <td class="col-md-1"><%= book.page_count %></td>
          <td class="col-md-1"><%= book.about %></td>
          <td class="col-md-1"><%= link_to book.user.login, book.user %></td>
          <td class="col-md-1"><%= book.created_at %></td>
          <td class="col-md-1"><%= book.binding %></td>
          <td class="col-md-1"><%= book.genre %></td>
          <td class="col-md-1 warning"><%= link_to 'Show', book %>
          <% if admin? current_user %>
              <%= link_to 'Edit', edit_book_path(book) %>
              <%= link_to 'Destroy', book, method: :delete, data: { confirm: 'Are you sure?' } %>
          <% end %>
          </td>
          <td><%= image_tag book.images.first.image.url, size: '150x100'  if book.images.first.present?   %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <br>
</nav>
<%= paginate @books %>


<%= link_to 'New Book', new_book_path %>